<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Profile Wizard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .wizard-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .wizard-header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .wizard-header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .progress-bar-container {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            height: 8px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-bar {
            background: rgba(255,255,255,0.8);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 14.28%; /* 1/7 steps */
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .step {
            opacity: 0.6;
            transition: opacity 0.3s;
        }

        .step.active {
            opacity: 1;
            font-weight: 600;
        }

        .step.completed {
            opacity: 0.8;
        }

        .wizard-content {
            padding: 40px;
            min-height: 500px;
        }

        .step-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 10px;
        }

        .step-description {
            color: #6b7280;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 5px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .resume-upload {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 60px 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: #fafafa;
        }

        .resume-upload:hover {
            border-color: #4f46e5;
            background: #f8faff;
        }

        .resume-upload.dragover {
            border-color: #4f46e5;
            background: #f0f4ff;
        }

        .upload-icon {
            font-size: 4rem;
            color: #9ca3af;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #6b7280;
        }

        .progress-container {
            display: none;
            margin-top: 30px;
            text-align: left;
        }

        .upload-progress-bar {
            width: 100%;
            height: 12px;
            background: #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
            margin: 15px 0;
        }

        .upload-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            width: 0%;
            transition: width 0.3s ease;
        }

        .skip-upload {
            margin-top: 20px;
            color: #6b7280;
            text-decoration: underline;
            cursor: pointer;
        }

        .skip-upload:hover {
            color: #4f46e5;
        }

        .entry-item {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .entry-title {
            font-weight: 600;
            color: #374151;
        }

        .remove-entry {
            background: none;
            color: #9ca3af;
            border: none;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-entry:hover {
            background: #fee2e2;
            color: #dc2626;
            transform: scale(1.1);
        }

        .remove-entry:active {
            transform: scale(0.95);
        }

        .add-entry-btn {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            margin-top: 20px;
        }

        .add-entry-btn:hover {
            background: #4338ca;
        }

        .skill-experience-item {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .skill-experience-item.annotated {
            border-color: #fbbf24;
            background: #fffbeb;
        }

        .ai-annotation {
            margin-top: 8px;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            display: none;
            border: 1px solid;
            position: relative;
        }

        .ai-annotation.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-annotation.success {
            background: #ecfdf5;
            color: #047857;
            border-color: #10b981;
        }

        .ai-annotation.info {
            background: #eff6ff;
            color: #1d4ed8;
            border-color: #3b82f6;
        }

        .ai-annotation.question {
            background: #fffbeb;
            color: #d97706;
            border-color: #f59e0b;
        }

        .ai-annotation.warning {
            background: #fef3c7;
            color: #92400e;
            border-color: #fbbf24;
        }

        .ai-annotation::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 20px;
            width: 12px;
            height: 12px;
            background: inherit;
            border: inherit;
            border-bottom: none;
            border-right: none;
            transform: rotate(45deg);
        }

        .ai-review-panel {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            display: none;
        }

        .ai-review-panel.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-review-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .ai-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #0ea5e9, #3b82f6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .ai-review-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #0c4a6e;
        }

        .ai-feedback-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #0ea5e9;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-size: 16px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .availability-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .availability-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .availability-option:hover {
            background: #f3f4f6;
        }

        .availability-option input[type="checkbox"] {
            width: auto;
        }

        .hidden {
            display: none;
        }

        .ai-analysis-container {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0ea5e9;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            display: none;
            animation: slideIn 0.4s ease-out;
        }

        .ai-analysis-container.show {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-analysis-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .ai-analysis-icon {
            width: 24px;
            height: 24px;
            border: 3px solid #0ea5e9;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .ai-analysis-title {
            font-weight: 600;
            color: #0c4a6e;
            font-size: 1.1rem;
        }

        .ai-progress-bar {
            height: 8px;
            background: rgba(14, 165, 233, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .ai-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0ea5e9, #3b82f6);
            border-radius: 4px;
            width: 0%;
            transition: width 0.4s ease;
        }

        .ai-progress-text {
            color: #0c4a6e;
            font-size: 0.9rem;
            text-align: center;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .availability-grid {
                grid-template-columns: 1fr;
            }
            
            .wizard-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <div class="wizard-header">
            <h1>Student Profile Setup</h1>
            <p>Let's create your comprehensive student profile</p>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="step-indicator">
                <div class="step active" data-step="1">Resume</div>
                <div class="step" data-step="2">Basic Info</div>
                <div class="step" data-step="3">Education</div>
                <div class="step" data-step="4">Employment</div>
                <div class="step" data-step="5">Skills</div>
                <div class="step" data-step="6">Availability</div>
                <div class="step" data-step="7">Preferences</div>
            </div>
        </div>

        <div class="wizard-content">
            <!-- Step 1: Resume Upload -->
            <div class="step-content active" data-step="1">
                <h2 class="step-title">Upload Your Resume (Optional)</h2>
                <p class="step-description">Upload your resume to help us pre-populate your profile information</p>
                
                <div class="resume-upload" onclick="document.getElementById('resumeFile').click()">
                    <div class="upload-icon">📄</div>
                    <div class="upload-text">Click to upload or drag and drop</div>
                    <div class="upload-subtext">PDF, DOC, or DOCX files accepted</div>
                    <input type="file" id="resumeFile" accept=".pdf,.doc,.docx" style="display: none;">
                </div>
                
                <div class="progress-container" id="uploadProgress">
                    <p><strong>Analyzing your resume...</strong></p>
                    <div class="upload-progress-bar">
                        <div class="upload-progress-fill" id="uploadProgressFill"></div>
                    </div>
                    <p id="uploadProgressText">Extracting information... 0%</p>
                </div>
                
                <div class="skip-upload" onclick="nextStep()">Skip this step and fill manually</div>
            </div>

            <!-- Step 2: Basic Information -->
            <div class="step-content" data-step="2">
                <h2 class="step-title">Basic Information</h2>
                <p class="step-description">Tell us about yourself</p>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" name="firstName" placeholder="Your first name">
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" name="lastName" placeholder="Your last name">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" placeholder="your.email@university.edu">
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" name="phone" placeholder="(555) 123-4567">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="academicYear">Academic Year</label>
                        <select id="academicYear" name="academicYear">
                            <option value="">Select your year</option>
                            <option value="freshman">Freshman</option>
                            <option value="sophomore">Sophomore</option>
                            <option value="junior">Junior</option>
                            <option value="senior">Senior</option>
                            <option value="graduate">Graduate Student</option>
                            <option value="postgrad">Post-Graduate</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="university">University</label>
                        <input type="text" id="university" name="university" placeholder="Your university name">
                    </div>
                </div>
            </div>

            <!-- Step 3: Education History -->
            <div class="step-content" data-step="3">
                <h2 class="step-title">Education History</h2>
                <p class="step-description">Add your educational background</p>
                
                <div id="educationEntries">
                    <div class="entry-item">
                        <div class="entry-header">
                            <div class="entry-title">Education Entry 1</div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Institution</label>
                                <input type="text" name="institution" placeholder="University or School name">
                            </div>
                            <div class="form-group">
                                <label>Degree/Program</label>
                                <input type="text" name="degree" placeholder="e.g., Bachelor of Science">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Field of Study</label>
                                <input type="text" name="field" placeholder="e.g., Computer Science">
                            </div>
                            <div class="form-group">
                                <label>GPA (Optional)</label>
                                <input type="text" name="gpa" placeholder="e.g., 3.8/4.0">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Start Date</label>
                                <input type="month" name="startDate">
                            </div>
                            <div class="form-group">
                                <label>End Date (or Expected)</label>
                                <input type="month" name="endDate">
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="add-entry-btn" onclick="addEducationEntry()">+ Add Another Education Entry</button>
            </div>

            <!-- Step 4: Employment History -->
            <div class="step-content" data-step="4">
                <h2 class="step-title">Employment History</h2>
                <p class="step-description">Add your work experience, internships, and relevant positions</p>
                
                <div id="employmentEntries">
                    <div class="entry-item">
                        <div class="entry-header">
                            <div class="entry-title">Employment Entry 1</div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Company/Organization</label>
                                <input type="text" name="company" placeholder="Company name">
                            </div>
                            <div class="form-group">
                                <label>Position Title</label>
                                <input type="text" name="position" placeholder="Your job title">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Start Date</label>
                                <input type="month" name="startDate">
                            </div>
                            <div class="form-group">
                                <label>End Date</label>
                                <input type="month" name="endDate">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea name="description" rows="3" placeholder="Describe your responsibilities and achievements..."></textarea>
                        </div>
                    </div>
                </div>
                
                <button class="add-entry-btn" onclick="addEmploymentEntry()">+ Add Another Position</button>
                <div class="skip-upload" onclick="nextStep()">Skip if no employment history</div>
            </div>

            <!-- Step 5: Skills and Experience -->
            <div class="step-content" data-step="5">
                <h2 class="step-title">Skills & Experience</h2>
                <p class="step-description">List your skills and describe the experience that developed them</p>
                
                <div id="skillsEntries">
                    <div class="skill-experience-item">
                        <div class="entry-header">
                            <div class="entry-title">Skill/Experience 1</div>
                            <button class="remove-entry" onclick="removeSkillEntry(this)" title="Remove this entry">🗑️</button>
                        </div>
                        <div class="form-group">
                            <label>Skills (comma-separated)</label>
                            <input type="text" name="skills" placeholder="e.g., Python, Machine Learning, Data Analysis">
                        </div>
                        <div class="form-group">
                            <label>Experience & Context</label>
                            <textarea name="experience" rows="4" placeholder="Describe how you developed these skills, projects you've worked on, courses taken, etc..."></textarea>
                        </div>
                    </div>
                </div>
                
                <button class="add-entry-btn" onclick="addSkillEntry()">+ Add More Skills & Experience</button>
                
                <div class="ai-analysis-container" id="aiAnalysisContainer">
                    <div class="ai-analysis-header">
                        <div class="ai-analysis-icon"></div>
                        <div class="ai-analysis-title" id="aiAnalysisTitle">Analyzing your skills and experience...</div>
                    </div>
                    <div class="ai-progress-bar">
                        <div class="ai-progress-fill" id="aiProgressFill"></div>
                    </div>
                    <div class="ai-progress-text" id="aiProgressText">Starting analysis...</div>
                </div>
            </div>


            <!-- Step 6: Availability -->
            <div class="step-content" data-step="6">
                <h2 class="step-title">Availability</h2>
                <p class="step-description">When are you available to work on projects?</p>
                
                <label style="font-weight: 600; margin-bottom: 15px; display: block;">Select all that apply:</label>
                <div class="availability-grid">
                    <div class="availability-option">
                        <input type="checkbox" id="weekends" name="availability" value="weekends">
                        <label for="weekends">Weekends</label>
                    </div>
                    <div class="availability-option">
                        <input type="checkbox" id="evenings" name="availability" value="evenings">
                        <label for="evenings">Evenings (after classes)</label>
                    </div>
                    <div class="availability-option">
                        <input type="checkbox" id="summer" name="availability" value="summer">
                        <label for="summer">Summer Break</label>
                    </div>
                    <div class="availability-option">
                        <input type="checkbox" id="parttime" name="availability" value="parttime">
                        <label for="parttime">Part-time during semester</label>
                    </div>
                    <div class="availability-option">
                        <input type="checkbox" id="fulltime" name="availability" value="fulltime">
                        <label for="fulltime">Full-time (co-op/internship)</label>
                    </div>
                    <div class="availability-option">
                        <input type="checkbox" id="flexible" name="availability" value="flexible">
                        <label for="flexible">Flexible schedule</label>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="currentlyAvailable">Currently Available</label>
                        <select id="currentlyAvailable" name="currentlyAvailable">
                            <option value="">Select status</option>
                            <option value="yes">Yes, immediately</option>
                            <option value="no">No, not currently</option>
                            <option value="limited">Limited availability</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="availableDate">Available Starting</label>
                        <input type="date" id="availableDate" name="availableDate">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="availabilityNotes">Additional Availability Notes</label>
                    <textarea id="availabilityNotes" name="availabilityNotes" rows="3" placeholder="Any additional details about your availability, time commitments, etc..."></textarea>
                </div>
            </div>

            <!-- Step 7: Work Preferences -->
            <div class="step-content" data-step="7">
                <h2 class="step-title">Work Preferences</h2>
                <p class="step-description">Tell us about your work preferences and goals</p>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="remotePreference">Remote Work Preference</label>
                        <select id="remotePreference" name="remotePreference">
                            <option value="">Select preference</option>
                            <option value="remote">Fully remote preferred</option>
                            <option value="hybrid">Hybrid (mix of remote/in-person)</option>
                            <option value="onsite">On-site preferred</option>
                            <option value="flexible">No preference</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="locationFlexibility">Location Flexibility</label>
                        <select id="locationFlexibility" name="locationFlexibility">
                            <option value="">Select flexibility</option>
                            <option value="local">Local area only</option>
                            <option value="regional">Regional (within state)</option>
                            <option value="national">National</option>
                            <option value="international">Open to international</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="projectTypes">Preferred Project Types</label>
                    <textarea id="projectTypes" name="projectTypes" rows="3" placeholder="What types of projects interest you? (e.g., web development, research, mobile apps, data analysis)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="careerGoals">Career Goals</label>
                    <textarea id="careerGoals" name="careerGoals" rows="3" placeholder="What are your career goals and how do you hope these projects will help?"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="additionalInfo">Additional Information</label>
                    <textarea id="additionalInfo" name="additionalInfo" rows="3" placeholder="Anything else you'd like potential project partners to know?"></textarea>
                </div>
            </div>

            <!-- Navigation -->
            <div class="navigation" id="navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="prevStep()" disabled>← Previous</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextStep()">Next →</button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 7;
        let resumeUploaded = false;

        // Step navigation
        function updateStepIndicator() {
            const steps = document.querySelectorAll('.step');
            const progressBar = document.getElementById('progressBar');
            
            steps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    step.classList.add('active');
                }
            });
            
            const progressPercent = (currentStep / totalSteps) * 100;
            progressBar.style.width = progressPercent + '%';
        }

        function showStep(step) {
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelector(`.step-content[data-step="${step}"]`).classList.add('active');
            
            // Update navigation buttons
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const navigation = document.getElementById('navigation');
            
            prevBtn.disabled = step === 1;
            
            if (step === totalSteps) {
                nextBtn.textContent = 'Complete Profile';
                nextBtn.onclick = completeProfile;
            } else {
                nextBtn.textContent = 'Next →';
                nextBtn.onclick = nextStep;
            }
            
            navigation.style.display = 'flex';
            
            updateStepIndicator();
        }

        function nextStep() {
            if (currentStep === 5) {
                // Review skills with AI annotations before proceeding
                reviewSkillsWithAI();
                return;
            }
            
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        // Resume upload simulation
        document.getElementById('resumeFile').addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                simulateResumeUpload();
            }
        });

        function simulateResumeUpload() {
            const progressContainer = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('uploadProgressFill');
            const progressText = document.getElementById('uploadProgressText');
            
            progressContainer.style.display = 'block';
            
            const stages = [
                'Uploading file...',
                'Extracting text content...',
                'Analyzing structure...',
                'Identifying skills and experience...',
                'Processing education history...',
                'Finalizing profile data...'
            ];
            
            let progress = 0;
            let stageIndex = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 12 + 8;
                if (progress > 100) progress = 100;
                
                if (progress > (stageIndex + 1) * 16.66 && stageIndex < stages.length - 1) {
                    stageIndex++;
                }
                
                progressFill.style.width = progress + '%';
                progressText.textContent = stages[stageIndex] + ' ' + Math.round(progress) + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    progressText.textContent = 'Analysis complete! Moving to next step...';
                    resumeUploaded = true;
                    
                    setTimeout(() => {
                        populateFromResume();
                        nextStep();
                    }, 1500);
                }
            }, 300);
        }

        function populateFromResume() {
            // Simulate AI parsing results
            document.getElementById('firstName').value = 'Sarah';
            document.getElementById('lastName').value = 'Chen';
            document.getElementById('email').value = 'sarah.chen@university.edu';
            document.getElementById('phone').value = '(555) 123-4567';
            document.getElementById('academicYear').value = 'junior';
            document.getElementById('university').value = 'State University';
        }

        // Dynamic entry management
        function addEducationEntry() {
            const container = document.getElementById('educationEntries');
            const entryCount = container.children.length + 1;
            
            const entryHTML = `
                <div class="entry-item">
                    <div class="entry-header">
                        <div class="entry-title">Education Entry ${entryCount}</div>
                        <button class="remove-entry" onclick="removeEntry(this)" title="Remove this entry">🗑️</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Institution</label>
                            <input type="text" name="institution" placeholder="University or School name">
                        </div>
                        <div class="form-group">
                            <label>Degree/Program</label>
                            <input type="text" name="degree" placeholder="e.g., Bachelor of Science">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Field of Study</label>
                            <input type="text" name="field" placeholder="e.g., Computer Science">
                        </div>
                        <div class="form-group">
                            <label>GPA (Optional)</label>
                            <input type="text" name="gpa" placeholder="e.g., 3.8/4.0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Start Date</label>
                            <input type="month" name="startDate">
                        </div>
                        <div class="form-group">
                            <label>End Date (or Expected)</label>
                            <input type="month" name="endDate">
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', entryHTML);
        }

        function addEmploymentEntry() {
            const container = document.getElementById('employmentEntries');
            const entryCount = container.children.length + 1;
            
            const entryHTML = `
                <div class="entry-item">
                    <div class="entry-header">
                        <div class="entry-title">Employment Entry ${entryCount}</div>
                        <button class="remove-entry" onclick="removeEntry(this)" title="Remove this entry">🗑️</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Company/Organization</label>
                            <input type="text" name="company" placeholder="Company name">
                        </div>
                        <div class="form-group">
                            <label>Position Title</label>
                            <input type="text" name="position" placeholder="Your job title">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Start Date</label>
                            <input type="month" name="startDate">
                        </div>
                        <div class="form-group">
                            <label>End Date</label>
                            <input type="month" name="endDate">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea name="description" rows="3" placeholder="Describe your responsibilities and achievements..."></textarea>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', entryHTML);
        }

        function addSkillEntry() {
            const container = document.getElementById('skillsEntries');
            const entryCount = container.children.length + 1;
            
            const entryHTML = `
                <div class="skill-experience-item">
                    <div class="entry-header">
                        <div class="entry-title">Skill/Experience ${entryCount}</div>
                        <button class="remove-entry" onclick="removeSkillEntry(this)" title="Remove this entry">🗑️</button>
                    </div>
                    <div class="form-group">
                        <label>Skills (comma-separated)</label>
                        <input type="text" name="skills" placeholder="e.g., Python, Machine Learning, Data Analysis">
                    </div>
                    <div class="form-group">
                        <label>Experience & Context</label>
                        <textarea name="experience" rows="4" placeholder="Describe how you developed these skills, projects you've worked on, courses taken, etc..."></textarea>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', entryHTML);
        }

        function removeEntry(button) {
            button.closest('.entry-item').remove();
        }

        function removeSkillEntry(button) {
            button.closest('.skill-experience-item').remove();
        }

        // AI Review System
        function reviewSkillsWithAI() {
            const skillsEntries = document.querySelectorAll('.skill-experience-item');
            const nextBtn = document.getElementById('nextBtn');
            
            // Show loading state
            nextBtn.textContent = 'Analyzing...';
            nextBtn.disabled = true;
            
            // Clear existing annotations
            clearAllAnnotations();
            
            // Show AI analysis progress bar
            showAIAnalysisProgress();
            
            // Simulate AI analysis with progress
            setTimeout(() => {
                // Generate AI feedback as annotations
                generateFieldAnnotations(skillsEntries);
                
                // Hide progress bar
                hideAIAnalysisProgress();
                
                // Update button
                nextBtn.textContent = 'Continue to Availability →';
                nextBtn.disabled = false;
                nextBtn.onclick = () => {
                    currentStep++;
                    showStep(currentStep);
                };
            }, 3000);
        }

        function generateFieldAnnotations(skillsEntries) {
            let hasAnnotations = false;
            
            skillsEntries.forEach((entry, index) => {
                const skillsInput = entry.querySelector('input[name="skills"]');
                const experienceTextarea = entry.querySelector('textarea[name="experience"]');
                
                const skills = skillsInput.value.trim();
                const experience = experienceTextarea.value.trim();
                
                if (skills && experience) {
                    // Simulate AI analysis
                    const analysis = analyzeSkillsAndExperience(skills, experience);
                    
                    if (analysis.length > 0) {
                        hasAnnotations = true;
                        // Show annotations on the specific fields
                        analysis.forEach(feedback => {
                            const targetField = feedback.target === 'experience' ? experienceTextarea : skillsInput;
                            showFieldAnnotation(targetField, feedback.message, feedback.type);
                        });
                        
                        // Highlight the entry
                        entry.classList.add('annotated');
                    } else {
                        // Show success annotation
                        showFieldAnnotation(experienceTextarea, '✅ Great description! This gives a clear picture of your experience.', 'success');
                    }
                } else if (skills && !experience) {
                    hasAnnotations = true;
                    showFieldAnnotation(experienceTextarea, '📝 Please describe how you developed these skills to strengthen your profile.', 'question');
                    entry.classList.add('annotated');
                }
            });
            
            if (!hasAnnotations) {
                // Show general success message on the last entry
                const lastEntry = skillsEntries[skillsEntries.length - 1];
                if (lastEntry) {
                    const lastTextarea = lastEntry.querySelector('textarea[name="experience"]');
                    showFieldAnnotation(lastTextarea, '✅ Your skills and experience look comprehensive!', 'success');
                }
            }
        }

        function analyzeSkillsAndExperience(skills, experience) {
            const feedback = [];
            const skillList = skills.toLowerCase().split(',').map(s => s.trim());
            const experienceText = experience.toLowerCase();
            
            // Check for programming languages without project context
            const programmingLanguages = ['python', 'javascript', 'java', 'c++', 'react', 'node', 'html', 'css'];
            const mentionedLanguages = skillList.filter(skill => 
                programmingLanguages.some(lang => skill.includes(lang))
            );
            
            if (mentionedLanguages.length > 0 && !experienceText.includes('project') && !experienceText.includes('built') && !experienceText.includes('developed')) {
                feedback.push({
                    type: 'question',
                    target: 'experience',
                    message: `💡 You mentioned ${mentionedLanguages.slice(0,2).join(', ')}${mentionedLanguages.length > 2 ? ' and others' : ''}. Could you describe specific projects or applications you've built with these technologies?`
                });
            }
            
            // Check for soft skills without context
            const softSkills = ['leadership', 'communication', 'teamwork', 'management', 'collaboration'];
            const mentionedSoftSkills = skillList.filter(skill => 
                softSkills.some(soft => skill.includes(soft))
            );
            
            if (mentionedSoftSkills.length > 0 && experienceText.length < 100) {
                feedback.push({
                    type: 'info',
                    target: 'experience',
                    message: `📈 Great to see ${mentionedSoftSkills.join(', ')} skills! Consider adding specific examples of when you demonstrated these abilities.`
                });
            }
            
            // Check for data science skills
            if (skillList.some(skill => skill.includes('machine learning') || skill.includes('data') || skill.includes('analytics')) && 
                !experienceText.includes('dataset') && !experienceText.includes('analysis') && !experienceText.includes('model')) {
                feedback.push({
                    type: 'question',
                    target: 'experience',
                    message: '📊 You mentioned data/ML skills. What datasets have you worked with or what kind of analysis have you performed?'
                });
            }
            
            // Check for very short descriptions
            if (experienceText.length < 50 && skillList.length > 2) {
                feedback.push({
                    type: 'warning',
                    target: 'experience',
                    message: '✍️ Your experience description seems brief for the number of skills listed. Adding more context would help potential collaborators understand your background better.'
                });
            }
            
            return feedback;
        }

        function showFieldAnnotation(field, message, type) {
            // Remove existing annotation for this field
            const existingAnnotation = field.parentElement.querySelector('.ai-annotation');
            if (existingAnnotation) {
                existingAnnotation.remove();
            }
            
            // Create new annotation
            const annotation = document.createElement('div');
            annotation.className = `ai-annotation ${type} show`;
            annotation.textContent = message;
            
            // Add after the field
            field.parentElement.appendChild(annotation);
        }
        
        function clearAllAnnotations() {
            // Remove all existing annotations
            document.querySelectorAll('.ai-annotation').forEach(annotation => {
                annotation.remove();
            });
            
            // Remove annotation styling from entries
            document.querySelectorAll('.skill-experience-item').forEach(entry => {
                entry.classList.remove('annotated');
            });
        }

        function completeProfile() {
            alert('Profile completed successfully! In a real application, this would save your data and redirect you to your dashboard.');
        }

        // Drag and drop for resume upload
        const uploadArea = document.querySelector('.resume-upload');
        
        uploadArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('resumeFile').files = files;
                simulateResumeUpload();
            }
        });

        // AI Analysis Progress
        function showAIAnalysisProgress() {
            const container = document.getElementById('aiAnalysisContainer');
            const progressFill = document.getElementById('aiProgressFill');
            const progressTitle = document.getElementById('aiAnalysisTitle');
            const progressText = document.getElementById('aiProgressText');
            
            // Show the progress container
            container.classList.add('show');
            
            // Simulate analysis stages
            const stages = [
                { title: 'Reading your skills and experience...', text: 'Processing skill entries...', progress: 20 },
                { title: 'Analyzing skill-experience alignment...', text: 'Checking for context and examples...', progress: 45 },
                { title: 'Identifying gaps and opportunities...', text: 'Looking for areas to strengthen...', progress: 70 },
                { title: 'Generating personalized feedback...', text: 'Creating tailored suggestions...', progress: 90 },
                { title: 'Finalizing recommendations...', text: 'Almost done...', progress: 100 }
            ];
            
            let currentStage = 0;
            
            function updateProgress() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    progressTitle.textContent = stage.title;
                    progressText.textContent = stage.text;
                    progressFill.style.width = stage.progress + '%';
                    currentStage++;
                    
                    // Vary timing to feel more realistic
                    const delay = currentStage === 1 ? 800 : (currentStage === stages.length - 1 ? 400 : 600);
                    setTimeout(updateProgress, delay);
                }
            }
            
            // Start progress simulation
            setTimeout(updateProgress, 300);
        }
        
        function hideAIAnalysisProgress() {
            const container = document.getElementById('aiAnalysisContainer');
            if (container) {
                container.classList.remove('show');
            }
        }

        // Initialize
        showStep(1);
    </script>
</body>
</html>